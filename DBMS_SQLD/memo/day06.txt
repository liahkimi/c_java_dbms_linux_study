day06. 조인

SELECT 정리
	
	SELECT [DISTINCT] 컬럼명 [AS ALIAS]
	FROM 테이블명
	WHERE 조건식
	GROUP BY 그룹화 기준 컬럼
	HAVING 그룹 조건식
	ORDER BY 정렬 기준 컬럼 [ASC 또는 DESC];


	1. DISTINCT : 중복 제거
	2. ALIAS : 별칭
	3. GROUP BY : 그룹화
	4. HAVING : 그룹 조회 기준
	5. ORDER BY : 정렬
	6. WHERE : 조회 조건 


조인(JOIN)

	여러 테이블에 흩어져 있는 정보 중 사용자가 필요한 정보만 가져와서
	가상의 테이블처럼 만들고 결과를 보여주는 것. 여러개의 테이블을 병합, 즉 연결한다

	정규화를 통해 테이블이 너무 많이 분리되어 있으면 테이블의 데이터를 사용할때 불편하기 때문에
	입력, 수정, 삭제의 성능을 향상시키기 위해서 JOIN을 통해 합친 후 사용한다



	1. 내부 조인(INNER JOIN) : 두 테이블에 모두 데이터가 존재
		- EQUI JOIN(등가 조인)
		- NON-EQUI JOIN(비등가 조인)
		- NATURAL JOIN(내추럴 조인)

	2. 외부 조인(OUTER JOIN) : 두 테이블중 하나의 테이블에만 데이터가 존재
		- LEFT OUTER JOIN
		- RIGHT OUTER JOIN
		- FULL OUTER JOIN

	3. 상호 조인 
		- CROSS JOIN(교차 조인)

	4. 셀프조인
		- SELF JOIN(셀프조인)


안시(ANSI) 조인과 오라클 조인

	- ANSI 조인(오라클 10g 버전부터) : 데이터베이스 종류와 상관없이 모든 데이터베이스에 사용가능. 
	미국 국가 표준 협회 기준.
	- ORACLE 조인(오라클 9i버전까지) : ORACLE 데이터베이스에서만 사용 가능


내부 조인(INNER JOIN)
	
	1. 등가조인
	2. 비등가조인
	3. 내추럴조인

등가 조인(EQUI JOIN)

	두 테이블간의 컬럼의 값이 서로 일치할때. ON절에 등호(=)가 있을 때
	일반적으로 PK <-> FK 관계를 이용하여 조인을 주로 사용한다
	두 테이블 간에 관계가 있다면 (FK가 존재한다면) 부모 테이블의 PK와 자식 테이블의 FK를 
	등호로 비교가 가능하기 때문에 등가조인 사용이 가능하다

	1. 오라클

	SELECT 테이블1.컬럼명, 테이블2.컬럼명...
	FROM 테이블1, 테이블2
	WHERE 테이블2.컬럼명 = 테이블1.컬럼명

	WHERE : 테이블의 조인 조건과 조회 조건을 작성
	N개의 테이블을 조인할때 필요한 조인조건 = N-1개

	2.ANSI

	SELECT 테이블1.컬럼명, 테이블2.컬럼명...
	FROM 테이블명1 [INNER] JOIN 테이블명
	ON 테이블명1.컬럼명 = 테이블명2.컬럼명
	WHERE 조건식;

	INNER 키워드 생략 가능
	ON : 테이블의 조인 조건
	WHERE : 데이터 조회 조건

비등가 조인(NON EQUI JOIN)

	ON절에 등호(=)가 없을 때. 특정 컬럼의 값이 일치하지 않는 경우
	= 연산자가 아닌 BETWEEN, >, >=, <, <= 등의 연산자를 사용

	1. 오라클

	SELECT 테이블1.컬럼명, 테이블2.컬럼명..
	FROM 테이블1, 테이블2
	WHERE 테이블1.컬럼명 BETWEEN 테이블2.컬럼명 AND 테이블2.컬럼명;

	2. 안시

	SELECT 테이블1.컬럼명, 테이블2.컬럼명..
	FROM 테이블1 
	INNER JOIN 테이블2 ON 테이블1.컬럼명 BETWEEN 테이블2.컬럼명 AND 테이블2.컬럼명;


내추럴조인(NATURAL JOIN)

	동일한 이름의 모든 컬럼들에 대해 등가 조인을 수행한다
	조인되는 컬럼들의 자료형, 컬럼명이 일치해야 한다
	USING, ON, WHERE 절에서 조인 조건을 지정하지 못한다

	
	SELECT 공통 컬럼명, 테이블1.컬럼명, 테이블2.컬럼명...
	FROM 테이블명1 NATURAL JOIN 테이블명2;


USING 조건절

	동일한 이름의 컬럼들 중 지정한 컬럼들에 대해서 등가 조인을 수행한다

	SELECT 컬럼명...
	FROM 테이블명 JOIN 테이블명
	USING (조인에 사용할 컬럼명)
	조인에 사용된 같인 이름의 컬럼을 하나로 처리


여러개의 테이블 조인

	n개의 테이블을 조인 할때는 n-1개의 조인 조건이 필요하다
	여러개의 테이블을 조인해도 2개의 테이블씩 조인이 진행된다(순서는 내부의 옵티마이저가 결정)

	1. 오라클

	SELECT 테이블1.컬럼명, 테이블2.컬럼명, 테이블3.컬럼명...
	FROM 테이블1, 테이블2, 테이블3
	WHERE 테이블1.컬럼명 = 테이블2.컬럼명 AND 테이블2.컬럼명 = 테이블3.컬럼명


	2. 안시

	SELECT 테이블1.컬럼명, 테이블2.컬럼명, 테이블3.컬럼명...
	FROM 테이블1 
	JOIN 테이블2 ON 테이블1.컬럼명 = 테이블2.컬럼명
	JOIN 테이블3 ON 테이블2.컬럼명 = 테이블3.컬럼명


외부조인(OUTER JOIN)

	1. LEFT OUTER JOIN
	2. RIGHT OUTER JOIN
	3. FULL OUTER JOIN
	4. CROSS JOIN

	* 조인 조건을 만족하지 않는 행들도 함께 반환한다
	* 두개의 테이블을 조인할때, 하나의 테이블에 존재하는 데이터가 다른 테이블에도 존재하지 않을 경우

LEFT OUTER JOIN

	왼쪽(기준) 테이블의 모든 행과 오른쪽 테이블에서 일치하는 행을 가져온다
	기준테이블이 왼쪽 테이블
	오른쪽 테이블에서 조인 조건을 만족하면 그대로, 만족하지 않으면 NULL로 가져온다
	왼쪽 테이블은 모든 행을 가져온다

	1. 안시

	SELECT 컬럼명
	FROM 왼쪽테이블(기준테이블) 
	LEFT OUTER JOIN 오른쪽테이블 ON 조인조건;


	2. 오라클

	SELECT 컬럼명
	FROM 테이블1, 테이블2
	WHERE 테이블1.컬럼명 = 테이블2.컬럼명(+);
	(+) 반대편에 있는 테이블이 OUTER JOIN의 기준 테이블


RIGHT OUTER JOIN

	오른쪽(기준) 테이블의 모든행과 왼쪽 테이블에서 일치하는 행을 가져온다
	기준 테이블이 오른쪽 테이블
	왼쪽테이블에서 조인조건을 만족하면 그대로, 만족하지 않으면 NULL로 가져온다
	오른쪽 테이블은 모든 행을 가져온다

	1. 안시

	SELECT 컬럼명
	FROM 왼쪽테이블
	RIGHT OUTER JOIN 오른쪽테이블(기준테이블) ON 조인조건;


	2. 오라클
	
	SELECT 컬럼명
	FROM 테이블1, 테이블2
	WHERE 테이블1.컬럼명(+) = 테이블2.컬럼명;
	(+) 반대편에 있는 테이블이 OUTER JOIN의 기준 테이블


FULL OUTER JOIN

	LEFT OUTER JOIN + RIGHT OUTER JOIN 
	조인 조건을 만족하는 행들은 1번만 표기된다

	1. 안시

	SELECT 컬럼명
	FROM 테이블1 
	FULL OUTER JOIN 테이블2ON 조인조건;


CROSS JOIN

	두 개의 테이블 간의 모든 가능한 조합을 생성한다
	조인 조건을 지정하지 않고 사용한다
	테이블1 행의 수 x 테이블2 행의 수 결과를 반환한다
	카테시안의 곱이라고도 부른다(CARTESIAN PRODUCT)

	1. 안시

	SELECT 테이블1.컬럼명, 테이블2.컬럼명
	FROM 테이블1 CROSS JOIN 테이블2;

셀프조인

	하나의 테이블에서 자기 자신과 조인한다





















